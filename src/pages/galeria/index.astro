---
import Layout from "~/layouts/Layout.astro";
import Hero from "~/modules/gallery/components/hero.astro";
---

<style>
  .gallery-grid-page {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 25px;
    padding-bottom: 100px;
  }

  .gallery-item-page {
    position: relative;
    border-radius: var(--border-radius-lg);
    overflow: hidden;
    border: 1px solid var(--glass-border);
    cursor: pointer;
    aspect-ratio: 1 / 1; /* Cuadradas para que se vean bien en grid */
  }

  .gallery-item-page img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

  .gallery-item-page:hover img {
    transform: scale(1.08);
  }

  .gallery-overlay-page {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    padding: 25px;
    background: linear-gradient(
      to top,
      rgba(0, 0, 0, 0.9) 0%,
      rgba(0, 0, 0, 0.4) 70%,
      transparent 100%
    );
    transform: translateY(100%);
    opacity: 0;
    transition: all 0.4s ease-out;
  }

  .gallery-item-page:hover .gallery-overlay-page {
    transform: translateY(0);
    opacity: 1;
  }

  .overlay-title {
    font-size: 1.2rem;
    margin-bottom: 5px;
    color: white;
  }
  .overlay-category {
    font-size: 0.8rem;
    color: var(--color-accent);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  /* --- Lightbox (Para ver imágenes en grande) --- */
  .lightbox {
    display: none; /* Inicialmente oculto */
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.9);
    z-index: 2000;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  .lightbox.active {
    opacity: 1;
    display: flex;
  }

  .lightbox-img {
    max-width: 90%;
    max-height: 90%;
    border-radius: var(--border-radius-lg);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
  }

  .close-lightbox {
    position: absolute;
    top: 40px;
    right: 40px;
    color: white;
    font-size: 2.5rem;
    cursor: pointer;
    background: rgba(0, 0, 0, 0.4);
    border-radius: 50%;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.3s ease;
  }
  .close-lightbox:hover {
    background: rgba(255, 255, 255, 0.2);
  }

  .text-accent {
    color: var(--color-accent);
  }
</style>

<Layout>
  <Hero />

  <article class="container">
    <div class="gallery-grid-page">
      <div class="gallery-item-page" data-category="ceramico">
        <img
          src="https://images.unsplash.com/photo-1619767886558-efdc259cde1a?q=80&w=600&auto=format&fit=crop"
          alt="Porsche 911 Cerámico"
        />
        <div class="gallery-overlay-page">
          <span class="overlay-category">Cerámico</span>
          <h3 class="overlay-title">Porsche 911 Carrera</h3>
        </div>
      </div>
      <div class="gallery-item-page" data-category="polarizado">
        <img
          src="https://images.unsplash.com/photo-1635776885479-408c448fbde0?q=80&w=600&auto=format&fit=crop"
          alt="Interior con polarizado"
        />
        <div class="gallery-overlay-page">
          <span class="overlay-category">Polarizado</span>
          <h3 class="overlay-title">BMW M4 Coupé</h3>
        </div>
      </div>
      <div class="gallery-item-page" data-category="restauracion">
        <img
          src="https://images.unsplash.com/photo-1552519507-da3b142c6e3d?q=80&w=600&auto=format&fit=crop"
          alt="Corvette restauración"
        />
        <div class="gallery-overlay-page">
          <span class="overlay-category">Restauración</span>
          <h3 class="overlay-title">Corvette Stingray</h3>
        </div>
      </div>
      <div class="gallery-item-page" data-category="grabado">
        <img
          src="https://images.unsplash.com/photo-1600706432619-6616519d6003?q=80&w=600&auto=format&fit=crop"
          alt="Grabado de patente"
        />
        <div class="gallery-overlay-page">
          <span class="overlay-category">Grabado</span>
          <h3 class="overlay-title">Grabado de Patente</h3>
        </div>
      </div>
      <div class="gallery-item-page" data-category="ceramico">
        <img
          src="https://images.unsplash.com/photo-1549488331-cf1b2413e2f5?q=80&w=600&auto=format&fit=crop"
          alt="Mustang con cerámico"
        />
        <div class="gallery-overlay-page">
          <span class="overlay-category">Cerámico</span>
          <h3 class="overlay-title">Ford Mustang GT</h3>
        </div>
      </div>
      <div class="gallery-item-page" data-category="restauracion">
        <img
          src="https://images.unsplash.com/photo-1582234032549-923f03b5f7e7?q=80&w=600&auto=format&fit=crop"
          alt="Mercedes Benz clásico"
        />
        <div class="gallery-overlay-page">
          <span class="overlay-category">Restauración</span>
          <h3 class="overlay-title">Mercedes Clásico</h3>
        </div>
      </div>
    </div>
  </article>

  <div id="lightbox" class="lightbox">
    <span class="close-lightbox">&times;</span>
    <img src="" alt="Imagen grande" class="lightbox-img" />
  </div>
</Layout>

<script>
  // --- Lightbox Functionality ---
  const lightbox = document.getElementById("lightbox");
  const lightboxImg = lightbox.querySelector(".lightbox-img");
  const closeLightbox = lightbox.querySelector(".close-lightbox");
  const galleryItems = document.querySelectorAll(".gallery-item-page");

  galleryItems.forEach((item) => {
    item.addEventListener("click", () => {
      lightbox.classList.add("active");
      lightboxImg.src = item.querySelector("img").src;
    });
  });

  closeLightbox.addEventListener("click", () => {
    lightbox.classList.remove("active");
  });

  lightbox.addEventListener("click", (e) => {
    if (e.target === lightbox) {
      // Si hace clic fuera de la imagen
      lightbox.classList.remove("active");
    }
  });

  // --- Filter Functionality ---
  const filterButtons = document.querySelectorAll(".filter-btn");
  const galleryGrid = document.querySelector(".gallery-grid-page");

  filterButtons.forEach((button) => {
    button.addEventListener("click", () => {
      // Eliminar 'active' de todos los botones
      filterButtons.forEach((btn) => btn.classList.remove("active"));
      // Añadir 'active' al botón clickeado
      button.classList.add("active");

      const filter = button.dataset.filter; // 'all', 'ceramico', etc.

      galleryItems.forEach((item) => {
        const category = item.dataset.category;
        if (filter === "all" || category === filter) {
          item.style.display = "block"; // Mostrar
        } else {
          item.style.display = "none"; // Ocultar
        }
      });
      // Pequeño truco para que el grid se reacomode con una transición suave
      galleryGrid.style.transition = "none";
      void galleryGrid.offsetWidth; // Trigger reflow
      galleryGrid.style.transition = "all 0.4s ease";
    });
  });
</script>
